# 三个数据集从 PCAP 到训练的完整指令汇总

> 默认工作目录：`/mnt1/wyf/reproduce/AN-net-reproduce`
>
> 默认已激活 Conda 环境：`conda activate ANNet`

---

## 1. ISCXVPN（VPN 数据集）

### 1.1 从 PCAP 提取 RawData

原始 PCAP 根目录：`/mnt1/zs/Dataset/VPN`

```bash
python data_extract.py \
  --dataset ISCXVPN \
  --iscxvpn_root /mnt1/zs/Dataset/VPN
```

生成目录示例：

```text
RawData/ISCXVPN/<class>/
  xxx_T.npy  # 到达时间差序列
  xxx_L.npy  # 负载长度序列
  xxx_P.npy  # TCP 报文字节片段（hex）
  xxx_O.npy  # TTL 序列
  xxx_F.npy  # IPFlag 序列
  xxx_C.npy  # TCPFlag 序列
```

### 1.2 生成训练特征（ShortTerm）

```bash
python data_process.py --methods ShortTerm --datasets ISCXVPN
```

生成目录示例：

```text
data_0.0/ISCXVPN/<class>/ShortTerm/*.npy
```

### 1.3 训练 / 测试（ShortTerm 主方法）

```bash
python -u main.py --dataset 1 --noise 0.0 --method ShortTerm
```

---

## 2. CipherSpectrum

### 2.1 从 PCAP 提取 RawData

原始 PCAP 根目录：`/mnt1/lb/Datasets/CipherSpectrum`

```bash
python data_extract.py \
  --dataset CipherSpectrum \
  --cipher_root /mnt1/lb/Datasets/CipherSpectrum
```

生成目录示例：

```text
RawData/CipherSpectrum/<domain>/
  xxx_T.npy, xxx_L.npy, xxx_P.npy, xxx_O.npy, xxx_F.npy, xxx_C.npy
```

### 2.2 生成训练特征（ShortTerm）

```bash
python data_process.py --methods ShortTerm --datasets CipherSpectrum
```

生成目录示例：

```text
data_0.0/CipherSpectrum/<domain>/ShortTerm/*.npy
```

### 2.3 训练 / 测试（ShortTerm 主方法）

```bash
python -u main.py --dataset 0 --noise 0.0 --method ShortTerm
```

---

## 3. ISCXTor（Tor 数据集）

### 3.1 从 PCAP 提取 RawData

原始 PCAP 根目录：`/mnt1/zs/Dataset/Tor`

```bash
python data_extract.py \
  --dataset ISCXTor \
  --iscxtor_root /mnt1/zs/Dataset/Tor
```

生成目录示例：

```text
RawData/ISCXTor/<class>/
  xxx_T.npy, xxx_L.npy, xxx_P.npy, xxx_O.npy, xxx_F.npy, xxx_C.npy
```

### 3.2 生成训练特征（ShortTerm）

```bash
python data_process.py --methods ShortTerm --datasets ISCXTor
```

生成目录示例：

```text
data_0.0/ISCXTor/<class>/ShortTerm/*.npy
```

### 3.3 训练 / 测试（ShortTerm 主方法）

```bash
python -u main.py --dataset 2 --noise 0.0 --method ShortTerm
```

---

## 4. 一次性处理多个数据集（可选）

如果三个数据集的 RawData 都已准备好，可以一次性生成三套 ShortTerm 特征：

```bash
python data_process.py --methods ShortTerm --datasets CipherSpectrum ISCXVPN ISCXTor
```

之后再分别用不同的 `--dataset` 跑 `main.py` 进行训练 / 测试。
